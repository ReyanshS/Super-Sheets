/* Default light theme */
body {
    background-color: #f8f9fa;
    color: #212529;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
}

/* Dark theme styles */
body.dark-theme {
    background-color: #121212;
    color: #e0e0e0;
}

body.dark-theme h1 {
    color: #ffffff;
}

body.dark-theme .controls button,
body.dark-theme label#importCsvLabel {
    background-color: #333333;
    color: #ffffff;
}

body.dark-theme .controls button:hover,
body.dark-theme label#importCsvLabel:hover {
    background-color: #555555;
}

body.dark-theme table {
    background-color: #1e1e1e;
    border-color: #444444;
}

body.dark-theme th, body.dark-theme td {
    border-color: #444444;
    background-color: #1e1e1e;
    color: #e0e0e0;
}

body.dark-theme .header-cell, body.dark-theme .row-label {
    background-color: #333333;
    color: #ffffff;
}

body.dark-theme button.addRow, body.dark-theme button.addColumn {
    background-color: #007bff;
    color: white;
}

body.dark-theme button.deleteRow, body.dark-theme button.deleteColumn {
    background-color: #dc3545;
    color: white;
}

/* Highlight color for selected cells */
th:focus, td:focus {
    outline: 2px solid #0078d4; /* Bright blue highlight for focus */
    background-color: #e7f3ff; /* Light blue background for focused cells */
}

/* Highlight color for selected cells in dark mode */
body.dark-theme th:focus, body.dark-theme td:focus {
    outline: 2px solid #4caf50; /* Subtle green highlight for focus */
    background-color: #1f2d1f; /* Dark greenish background for focused cells */
}

/* Header and row labels in dark mode */
body.dark-theme .header-cell, body.dark-theme .row-label {
    background-color: #333333;
    color: #ffffff;
}

/* Ensure header cells (column labels) have the same color as row labels in dark mode */
body.dark-theme .header-cell {
    background-color: #333333; /* Same background color as row labels */
    color: #ffffff; /* Same text color as row labels */
}

/* Add/Remove buttons in dark mode */
body.dark-theme button.addRow, body.dark-theme button.deleteRow,
body.dark-theme button.addColumn, body.dark-theme button.deleteColumn {
    background-color: #555555; /* Lighter gray for better visibility */
    color: #ffffff;
}

body.dark-theme button.addRow:hover, body.dark-theme button.deleteRow:hover,
body.dark-theme button.addColumn:hover, body.dark-theme button.deleteColumn:hover {
    background-color: #0078d4; /* Bright blue on hover for better contrast */
    color: #ffffff;
}

/* Styling for the title "Super Sheets" */
h1 {
    text-align: center;
    font-size: 3rem; /* Increase font size for emphasis */
    margin-bottom: 20px;
    font-family: 'Pacifico', cursive; /* Use the Pacifico font */
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2); /* Add a subtle shadow for depth */
}

controls {
  text-align: center;
  margin-bottom: 20px;
}

button, input[type="file"], label#importCsvLabel {
  padding: 10px 20px;
  font-size: 1rem;
  color: #fff;
  background-color: #007bff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  margin: 5px;
  transition: background-color 0.3s;
}

button:hover, label#importCsvLabel:hover {
  background-color: #0056b3;
}

label#importCsvLabel {
  display: inline-block;
  cursor: pointer;
  background-color: #007bff;
  color: #fff;
  border-radius: 5px;
  padding: 10px 20px;
  font-size: 1rem;
  transition: background-color 0.3s;
}

label#importCsvLabel:hover {
  background-color: #0056b3;
}

table {
  border-collapse: collapse;
  width: 100%;
  margin-top: 20px;
  background-color: #fff;
  border: 1px solid #dee2e6;
}

th, td {
  border: 1px solid #dee2e6;
  text-align: center;
  padding: 8px;
  position: relative;
}

.header-cell, .row-label {
  background-color: #e9ecef;
  font-weight: bold;
}

/* Ensure hover buttons are hidden by default */
.hover-buttons {
  display: none;
  position: absolute;
  gap: 4px;
}

/* Show row buttons on hover */
.row-label:hover .hover-buttons {
  display: flex;
}

/* Show column buttons on hover */
.header-cell:hover .hover-buttons {
  display: flex;
}

/* Position hover buttons to the right of the row label */
.row-label .hover-buttons {
  right: 5px; /* Keep buttons to the right of the row number */
  top: 50%;
  transform: translateY(-50%);
  flex-direction: row; /* Align buttons horizontally */
  gap: 5px; /* Add spacing between buttons */
}

/* Position hover buttons for columns */
.header-cell .hover-buttons {
  right: 5px;
  top: 50%;
  transform: translateY(-50%);
  flex-direction: row; /* Keep buttons horizontal */
  gap: 4px;
}

/* Ensure smaller button size */
button.addRow, button.deleteRow, button.addColumn, button.deleteColumn {
  background-color: #6c757d;
  border: none;
  border-radius: 3px;
  padding: 1px 3px; /* Smaller padding */
  color: #fff;
  font-size: 10px; /* Smaller font size */
  cursor: pointer;
}

/* Button hover effect */
button.addRow:hover, button.deleteRow:hover, button.addColumn:hover, button.deleteColumn:hover {
  background-color: #5a6268;
}

/* Add/Remove Row/Column buttons */
button.addRow, button.addColumn {
    background-color: #007bff !important; /* Blue for Add buttons */
    color: white;
    border: none;
    border-radius: 3px;
    padding: 1px 3px;
    font-size: 10px;
    cursor: pointer;
}

button.deleteRow, button.deleteColumn {
    background-color: #dc3545 !important; /* Red for Remove buttons */
    color: white;
    border: none;
    border-radius: 3px;
    padding: 1px 3px;
    font-size: 10px;
    cursor: pointer;
}

/* Hover effects for Add/Remove Row/Column buttons */
button.addRow:hover, button.addColumn:hover {
    background-color: #0056b3 !important; /* Darker blue on hover */
}

button.deleteRow:hover, button.deleteColumn:hover {
    background-color: #c82333 !important; /* Darker red on hover */
}

/* Add/Remove Column buttons in light mode */
button.addColumn {
    background-color: #007bff; /* Blue for Add buttons */
    color: white;
    border: none;
    border-radius: 3px;
    padding: 1px 3px;
    font-size: 10px;
    cursor: pointer;
}

button.deleteColumn {
    background-color: #dc3545; /* Red for Remove buttons */
    color: white;
    border: none;
    border-radius: 3px;
    padding: 1px 3px;
    font-size: 10px;
    cursor: pointer;
}

/* Hover effects for Add/Remove Column buttons in light mode */
button.addColumn:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

button.deleteColumn:hover {
    background-color: #c82333; /* Darker red on hover */
}

/* Header buttons in light mode */
button.addColumn, button.deleteColumn {
    background-color: #007bff; /* Blue for Add/Remove buttons in light mode */
    color: white;
    border: none;
    border-radius: 3px;
    padding: 1px 3px;
    font-size: 10px;
    cursor: pointer;
}

/* Hover effects for header buttons in light mode */
button.addColumn:hover, button.deleteColumn:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

/* Add/Remove Column buttons in dark mode */
body.dark-theme button.addColumn {
    background-color: #4caf50; /* Green for Add buttons in dark mode */
}

body.dark-theme button.deleteColumn {
    background-color: #f44336; /* Red for Remove buttons in dark mode */
}

/* Hover effects for Add/Remove Column buttons in dark mode */
body.dark-theme button.addColumn:hover {
    background-color: #388e3c; /* Darker green on hover */
}

body.dark-theme button.deleteColumn:hover {
    background-color: #d32f2f; /* Darker red on hover */
}

/* Header buttons in dark mode */
body.dark-theme button.addColumn, body.dark-theme button.deleteColumn {
    background-color: #28a745; /* Green for Add/Remove buttons in dark mode */
    color: white;
}

/* Hover effects for header buttons in dark mode */
body.dark-theme button.addColumn:hover, body.dark-theme button.deleteColumn:hover {
    background-color: #218838; /* Darker green on hover */
}

/* Styling for Import CSV */
#csvInput {
    display: none;
}

/* General styling for Import CSV */
#importCsvLabel {
    display: inline-block; /* Make it behave like a button */
    padding: 8px 16px;
    background-color: #007bff; /* Blue background */
    color: white;
    border: none; /* Remove border */
    border-radius: 4px; /* Rounded corners */
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
    text-align: center;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Subtle shadow */
}

/* Hover effect for Import CSV */
#importCsvLabel:hover {
    background-color: #0056b3; /* Darker blue on hover */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Stronger shadow on hover */
}

/* Dark mode styling for Import CSV */
body.dark-theme #importCsvLabel {
    background-color: #28a745; /* Green background */
}

body.dark-theme #importCsvLabel:hover {
    background-color: #218838; /* Darker green on hover */
}

/* Hide the actual file input */
#importCsvLabel input {
    display: none; /* Hide the actual file input */
}

/* General styling for Import CSV */
#importCsvLabel {
    display: inline-block; /* Make it behave like a button */
    padding: 8px 16px;
    background-color: #007bff; /* Blue background */
    color: white;
    border: none; /* Remove border */
    border-radius: 4px; /* Rounded corners */
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
    text-align: center;
    transition: background-color 0.3s ease;
    box-sizing: border-box; /* Ensure padding and border are included in size */
    height: 38px; /* Match the height of other buttons */
    line-height: 20px; /* Vertically center text */
}

/* Remove the border and default styles of the file input */
#importCsvLabel input {
    display: none; /* Hide the actual file input */
}

/* Ensure the span inside the label looks like a button */
#importCsvLabel span {
    display: inline-block;
    width: 100%; /* Ensure it fills the label */
    height: 100%; /* Match the height of the label */
    text-align: center;
    line-height: 20px; /* Vertically center text */
}

/* Light mode styling for Import CSV */
body:not(.dark-theme) #importCsvLabel {
    background-color: #007bff; /* Blue background */
}

body:not(.dark-theme) #importCsvLabel:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

/* Dark mode styling for Import CSV */
body.dark-theme #importCsvLabel {
    background-color: #28a745; /* Green background */
}

body.dark-theme #importCsvLabel:hover {
    background-color: #218838; /* Darker green on hover */
}

/* Import/Export CSV and Toggle Dark Mode buttons */
button#exportCsv, label#importCsvLabel, button#themeToggle {
    background-color: #007bff; /* Blue background */
    color: white;
    border: none;
    border-radius: 4px;
    padding: 8px 16px;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.3s;
}

button#exportCsv:hover, label#importCsvLabel:hover, button#themeToggle:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

/* Dark theme adjustments for Import/Export and Toggle buttons */
body.dark-theme button#exportCsv, 
body.dark-theme label#importCsvLabel, 
body.dark-theme button#themeToggle {
    background-color: #28a745; /* Green background for dark mode */
    color: white;
}

body.dark-theme button#exportCsv:hover, 
body.dark-theme label#importCsvLabel:hover, 
body.dark-theme button#themeToggle:hover {
    background-color: #218838; /* Darker green on hover */
}

body.dark-theme label#importCsvLabel {
    background-color: #28a745; /* Ensure consistent green background */
    color: white;
}

body.dark-theme label#importCsvLabel:hover {
    background-color: #218838; /* Darker green on hover */
}

/* Dark theme adjustments for Add/Remove Row/Column buttons */
body.dark-theme button.addRow, body.dark-theme button.addColumn {
    background-color: #007bff !important; /* Blue for Add buttons */
}

body.dark-theme button.addRow:hover, body.dark-theme button.addColumn:hover {
    background-color: #0056b3 !important; /* Darker blue on hover */
}

body.dark-theme button.deleteRow, body.dark-theme button.deleteColumn {
    background-color: #dc3545 !important; /* Red for Remove buttons */
}

body.dark-theme button.deleteRow:hover, body.dark-theme button.deleteColumn:hover {
    background-color: #c82333 !important; /* Darker red on hover */
}

/* Ensure cells resize proportionally */
#spreadsheet {
    table-layout: fixed;
    width: 100%;
    border-collapse: collapse;
}

/* Ensure cells are properly aligned */
#spreadsheet th, #spreadsheet td {
    border: 1px solid #ccc;
    text-align: center;
    vertical-align: middle; /* Center text vertically */
    padding: 0;
    width: calc(100% / 8); /* Adjust width for 7 columns + row label */
    height: 40px;
    overflow: hidden;
    white-space: nowrap;
    line-height: 40px; /* Center text horizontally */
}

/* Flex container for title and buttons */
.header-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

/* Style for the spreadsheet title */
.spreadsheet-title input {
    font-size: 16px;
    padding: 5px;
    width: 100%;
    max-width: 300px;
}

/* Align the controls section */
.controls {
    display: flex;
    gap: 10px; /* Add spacing between buttons */
}

.controls button,
.controls label {
    font-size: 14px;
    padding: 5px 10px;
    cursor: pointer;
}

/* General styling for the title box */
#spreadsheetTitle {
    font-size: 18px;
    font-weight: bold;
    padding: 10px;
    border: 2px solid #ccc;
    border-radius: 8px;
    width: 100%;
    max-width: 400px;
    margin: 10px auto;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

/* Light mode styling */
body:not(.dark-theme) #spreadsheetTitle {
    background-color: #f9f9f9;
    color: #333;
    border-color: #ddd;
}

/* Dark mode styling */
body.dark-theme #spreadsheetTitle {
    background-color: #333;
    color: #f9f9f9;
    border-color: #555;
    box-shadow: 0 2px 4px rgba(255, 255, 255, 0.1);
}

/* Extend the width of the spreadsheet title box */
#spreadsheetTitle {
    width: 800px !important; /* Force the width to 1.5 times the current size */
    padding: 8px !important; /* Add padding for better appearance */
    font-size: 16px !important; /* Adjust font size for readability */
    box-sizing: border-box !important; /* Include padding in the width calculation */
    margin-right: 20px !important; /* Add spacing between the title box and the Help button */
}

/* Ensure the title and help button are aligned */
.spreadsheet-title {
    display: flex; /* Use flexbox for alignment */
    align-items: center; /* Vertically align items */
    justify-content: flex-start; /* Align items to the left */
}

/* Style the Help button */
#helpButton {
    background-color: #007bff; /* Blue background */
    color: white; /* White text */
    border: none; /* Remove default border */
    border-radius: 50%; /* Make it circular */
    width: 32px; /* Set width */
    height: 32px; /* Set height */
    font-size: 18px; /* Set font size */
    font-weight: bold; /* Bold text */
    text-align: center; /* Center-align text */
    line-height: 32px; /* Vertically center text */
    cursor: pointer; /* Pointer cursor on hover */
    transition: background-color 0.3s; /* Smooth hover effect */
}

/* Hover effect for the Help button */
#helpButton:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

/* Dark mode styling for the Help button */
body.dark-theme #helpButton {
    background-color: #28a745; /* Green background */
    color: white; /* White text */
}

body.dark-theme #helpButton:hover {
    background-color: #218838; /* Darker green on hover */
}

/* General button styling */
button, #importCsvLabel span {
    background-color: #007bff; /* Blue background */
    color: #fff; /* White text */
    border: none; /* Remove default border */
    border-radius: 6px; /* Rounded corners */
    padding: 8px 12px; /* Padding for a comfortable size */
    font-size: 14px; /* Font size */
    font-weight: bold; /* Bold text */
    cursor: pointer; /* Pointer cursor on hover */
    transition: all 0.3s ease; /* Smooth transition for hover effects */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Subtle shadow */
}

/* Hover effect for buttons */
button:hover, #importCsvLabel span:hover {
    background-color: #0056b3; /* Darker blue on hover */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Stronger shadow on hover */
}

/* Disabled button styling */
button:disabled, #importCsvLabel span:disabled {
    background-color: #cccccc; /* Gray background for disabled state */
    color: #666666; /* Gray text for disabled state */
    cursor: not-allowed; /* Not-allowed cursor for disabled state */
    box-shadow: none; /* Remove shadow for disabled state */
}

/* Styling for the file input label (Import CSV) */
#importCsvLabel {
    display: inline-block; /* Make it behave like a button */
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
    text-align: center;
    transition: background-color 0.3s;
}

/* Light mode styling for Import CSV */
body:not(.dark-theme) #importCsvLabel {
    background-color: #007bff; /* Blue background */
    color: white;
}

body:not(.dark-theme) #importCsvLabel:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

/* Dark mode styling for Import CSV */
body.dark-theme #importCsvLabel {
    background-color: #28a745; /* Green background */
    color: white;
}

body.dark-theme #importCsvLabel:hover {
    background-color: #218838; /* Darker green on hover */
}

/* Hide the actual file input */
#importCsvLabel input {
    display: none;
}

/* Light mode styling for Import CSV */
body:not(.dark-theme) #importCsvLabel {
    display: inline-block;
    padding: 8px 16px;
    background-color: #007bff; /* Blue background */
    color: white;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
    text-align: center;
    transition: background-color 0.3s;
}

body:not(.dark-theme) #importCsvLabel:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

/* Dark mode styling for Import CSV */
body.dark-theme #importCsvLabel {
    display: inline-block;
    padding: 8px 16px;
    background-color: #28a745; /* Green background */
    color: white;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
    text-align: center;
    transition: background-color 0.3s;
}

body.dark-theme #importCsvLabel:hover {
    background-color: #218838; /* Darker green on hover */
}

/* Hide the actual file input */
#importCsvLabel input {
    display: none;
}

/* Light mode styling for Import CSV */
#importCsvLabel {
    display: inline-block;
    padding: 8px 16px;
    background-color: #007bff; /* Blue background */
    color: white;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
    text-align: center;
    transition: background-color 0.3s;
}

#importCsvLabel:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

/* Dark mode styling for Import CSV */
body.dark-theme label#importCsvLabel {
    background-color: #28a745; /* Green background */
    color: white;
}

body.dark-theme label#importCsvLabel:hover {
    background-color: #218838; /* Darker green on hover */
}

/* Ensure the table layout is fixed */
#spreadsheet {
    table-layout: fixed; /* Enforce fixed layout for the table */
    width: auto; /* Allow the table width to adjust dynamically */
    max-width: 100%; /* Ensure the table does not exceed the container width */
    border-collapse: collapse; /* Remove gaps between cells */
    overflow: hidden; /* Prevent resizing due to content overflow */
    margin: 0 auto; /* Center the table horizontally */
}

/* Set a fixed width and height for each cell */
#spreadsheet td, #spreadsheet th {
    width: 100px; /* Fixed width for each column */
    height: 40px; /* Fixed height for all cells */
    overflow: hidden; /* Hide overflowing content */
    text-overflow: ellipsis; /* Add ellipsis for overflowing text */
    white-space: nowrap; /* Prevent text from wrapping */
    box-sizing: border-box; /* Include padding and border in the width/height */
    padding: 0; /* Remove padding */
    margin: 0; /* Remove margin */
}

/* Add borders for better visibility */
#spreadsheet td, #spreadsheet th {
    border: 1px solid #ccc; /* Light gray border */
    text-align: center; /* Center-align text */
    vertical-align: middle; /* Vertically center text */
}

/* Ensure header cells also have fixed sizes */
#spreadsheet th {
    background-color: #e9ecef; /* Light gray background for headers */
    font-weight: bold; /* Bold text for headers */
}

/* Ensure header row (th elements) has the correct color in dark mode */
body.dark-theme #spreadsheet th {
    background-color: #333333; /* Match the row label background color */
    color: #ffffff; /* Match the row label text color */
    border-color: #444444; /* Match the border color for consistency */
}

/* Ensure header row (th elements) and cells (td elements) have white borders in dark mode */
body.dark-theme #spreadsheet th, 
body.dark-theme #spreadsheet td {
    border-color: #ffffff; /* White border for better visibility in dark mode */
}

/* Modal styling */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgba(0, 0, 0, 0.5); /* Black background with opacity */
}

/* Modal content box */
.modal-content {
    background-color: #fefefe;
    margin: 15% auto; /* Center the modal */
    padding: 20px;
    border: 1px solid #888;
    width: 50%; /* Adjust width as needed */
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

/* Close button */
.modal-content .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}

.modal-content .close:hover,
.modal-content .close:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
}

/* Styling for the Help button */
#helpButton {
    background-color: #007bff; /* Blue background */
    color: white;
    border: none;
    border-radius: 4px;
    padding: 8px 16px;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.3s;
}

#helpButton:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

/* Add a resizing handle for columns */
.column-resize-handle {
    position: absolute;
    top: 0;
    right: 0;
    width: 5px;
    height: 100%;
    cursor: col-resize;
    background-color: transparent; /* Invisible by default */
    z-index: 1;
}

/* Add a resizing handle for rows */
.row-resize-handle {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 5px;
    cursor: row-resize;
    background-color: transparent; /* Invisible by default */
    z-index: 1;
}

/* Highlight the resizing handle on hover */
.column-resize-handle:hover,
.row-resize-handle:hover {
    background-color: rgba(0, 0, 0, 0.2); /* Light gray highlight */
}

/* Ensure cell content uses the full space */
#spreadsheet td, #spreadsheet th {
    overflow: hidden; /* Prevent content from overflowing */
    word-wrap: break-word; /* Allow content to wrap within the cell */
    white-space: normal; /* Allow multi-line content */
    vertical-align: top; /* Align content to the top of the cell */
    padding: 5px; /* Add padding for better readability */
}

/* Scrollable container for the spreadsheet */
.spreadsheet-wrapper {
    overflow: auto; /* Enable both horizontal and vertical scrolling */
    max-height: 80vh; /* Limit the height to 80% of the viewport */
    max-width: 100%; /* Ensure the table does not exceed the container width */
    border: 1px solid #ccc; /* Optional: Add a border around the scrollable area */
    margin: 0 auto; /* Center the table horizontally */
}

/* Ensure the table layout is fixed */
#spreadsheet {
    table-layout: fixed; /* Enforce fixed layout for the table */
    width: 100%; /* Make the table span the full width of the container */
    border-collapse: collapse; /* Remove gaps between cells */
}